
# core compiling options
CC  = @CC@
CXX = @CXX@
FC  = @FC@

CXX_STD = -std=c++11
OPT_FLAGS = @TRAME_OPT_FLAGS@

ARMA_INCLUDE_PATH = @ARMA_INCLUDE_PATH@

# install location
INSTALL_PATH=@TRAME_INSTALL_PATH@

# source directories
SDIR = ./..
TRAME_DIR = $(SDIR)
TRAME_HEADER_DIR = @TRAME_INCLUDE_PATH@
TRAME_TEST_DIR = .

# general flags
CXXFLAGS = $(CXX_STD) -Wall $(OPT_FLAGS) $(ARMA_INCLUDE_PATH) -I$(TRAME_HEADER_DIR)
LIBS= -L@TRAME_INSTALL_PATH@ -l@TRAME_SHLIB_NAME@ @TRAME_BLAS_LAPACK@

# TraME Test Files
SOURCES_TRAME_SLVRS= $(TRAME_TEST_DIR)/arc_newton.cpp $(TRAME_TEST_DIR)/cupids_lp.cpp $(TRAME_TEST_DIR)/darum.cpp $(TRAME_TEST_DIR)/eap_nash.cpp $(TRAME_TEST_DIR)/ipfp.cpp $(TRAME_TEST_DIR)/jacobi.cpp $(TRAME_TEST_DIR)/max_welfare.cpp $(TRAME_TEST_DIR)/nodal_newton.cpp $(TRAME_TEST_DIR)/oap_lp.cpp
OBJECTS_TRAME_SLVRS= $(SOURCES_TRAME_SLVRS:.cpp=.test)

all: $(OBJECTS_TRAME_SLVRS)

# core TraME files
$(TRAME_TEST_DIR)/%.test: $(TRAME_TEST_DIR)/%.cpp
	$(CXX) $(CXXFLAGS) $< -o $@ $(LIBS)

# cleanup and install
.PHONY: clean
clean:
	@rm -rf *.so ./*.gcov ./*.gcno ./*.gcda ./*.dSYM ./*.test
